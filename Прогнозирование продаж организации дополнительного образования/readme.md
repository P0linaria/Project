## Цель

В данном проекте целью является проведение интеллектуального анализа данных, а именно:
1. Провести анализ данных для решения следующих задач:
- выяснить закономерности приобретений абонементов разными возрастными категориями по количеству занятий
- выяснить закономерность преобретений разовых занятий по цене занятия
- выяснить закономерности посещений различных направлений клиентами студии
- выяснить закономерности предоставления клиентам скидок при покупке абонементов
2. Построить модели, которые будут предсказывать количество покупок абонементов разными возрастными категориями и разовых занятий на 2023 год.

## Ход работы:
1. Наборы данных загружены и изучены
2. Произведена предобработка данных: скорректированы типы данных, обработаны пропуски, исследованы уникальные значения и аномалии.
3. Проведен исследовательский анализ данных.
4. Данные приведены к виду временных рядов
5. Данные изучены на наличие тредов и сезонности.
6. Наборы данных были разделены на три выборки: обучающая выборка, валидационная выборка и тестовая выборка в соотношении 8:1:1 соответственно.
7. Исследована константная модель.
8. Исследована модель линейной регрессии.
9. Исследована модель решающее дерево с различными гипперпараметрами от 2 до 20 с шагом 1.
10. Исследована модель случайный лес с различными гипперпараметрами depth от 2 до 20 с шагом 2, est от 1 до 500 с шагом 100.
11. Исследованы две модели градиентного бустинга:
- С помощью библиотеки CatBoots и n_estimators от 1 до 1000 с шагом 100, depth oт 1 до 10 с шагом 2
- С помощью библиотеки LightGBM и гиперпаметрами num_leave от 1 до 500 с шагом 100, depth от 1 до 10 с шагом 2
12. Полученные результаты сведены в таблицы.
13. Выбраны наилучшие модели и протестированы на тестовых данных.

## Результаты:
### Анализ данных
#### Покупка абонементов (взрослые)
1. Чаще всего покупают абонеметы на 4 занятия, безлимитные абонементы не пользуютя популярность, их продажи составляют все 0,1%
2. Скидки предоставляют клиентав в 58% случаев, при этом чаще всего скидка - 5%
3. Наиболее популярные направления: пилон акробатик, йога и dencehall, не пользуются популярностью такие направления, как contemporary, high-heels и k-pop

#### Покупка абонементов (дети)
1. Чаще всего покупают абонеметы на 8 занятия, безлимитные абонементы не пользуютя популярность, их продажи составляют все 0,2%
2. Скидки предоставляют клиентав в 52% случаев, при этом чаще всего скидка - 5%
3. Наиболее популярные направления: пилон акробатик и детский танец, не пользуются популярностью такие направления, как contemporary, sensual и k-pop

#### Покупка разовых занятий
1. Чаще всего разовые занятия стоят 600 рублей, реже всего 1200
2. Наиболее популярные направления: пилон акробатик, йога и dencehall

### Машинное обучение
#### Покупка абонементов (взрослые)
1. Для дальнейших предсказаний выбрана модель LightGBM
2. Результаты на тестовой выборке представлены ниже

|                         |               |
|-------------------------|---------------|
|Имя модели               |LightGBM       |
|leave                    |101            |
|depth                    |2              |
|RMSE                     |2.261734       |

#### Покупка абонементов (дети)
1. Для дальнейших предсказаний выбрана модель CatBoots
2. Результаты на тестовой выборке представлены ниже

|                         |               |
|-------------------------|---------------|
|Имя модели               |CatBoots       |
|n_estimators             |101            |
|depth                    |1              |
|RMSE                     |1.365248       |

#### Покупка разовых занятий
1. Для дальнейших предсказаний выбрана модель LightGBM
2. Результаты на тестовой выборке представлены ниже

|                         |               |
|-------------------------|---------------|
|Имя модели               |LightGBM       |
|leave                    |101            |
|depth                    |2              |
|RMSE                     |2.929938       |

### Предсказания

С помощью выбранных моделей предсказаны количества покупок на 2023 год и сохранены в файлы: predicted_a.csv, predicted_c.csv, predicted_o.csv
